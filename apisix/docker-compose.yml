services:
  api-gateway:
    build:
      context: .
    ports:
      - ${APISIX_PORT:-443}:${APISIX_PORT:-443}
    env_file:
      - path: ../env/apisix.env
      - path: ../env/apisix.local.env
        required: false
    volumes:
      - ./conf/apisix.yaml:/usr/local/apisix/conf/apisix.yaml
      - ./conf/config.yaml:/usr/local/apisix/conf/config.yaml
      - ./conf/debug.yaml:/usr/local/apisix/conf/debug.yaml
      - ../cert/odl.local.crt:/usr/local/apisix/conf/cert/odl.local.crt
      - ../cert/odl.local.key:/usr/local/apisix/conf/cert/odl.local.key
    secrets:
      - ol-ssl-cert
      - ol-ssl-key
    networks:
      ol-network:
        aliases:
          - mail.odl.local
          - keycloak.odl.local
          - learn.odl.local
          - api.odl.local

